<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora Simples Nacional - Restaurantes</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 3rem;
      max-width: 1200px;
      width: 100%;
    }

    h1 {
      color: #2d3748;
      margin: 0 0 0.5rem 0;
      font-size: 2rem;
      font-weight: 700;
    }

    .subtitle {
      color: #718096;
      margin: 0 0 2rem 0;
      font-size: 1.125rem;
    }

    .input-group {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      color: #4a5568;
      font-weight: 600;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
    }

    input {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 1.125rem;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    button {
      width: 100%;
      padding: 1rem;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.125rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    .results {
      margin-top: 2rem;
      padding: 2rem;
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      border-radius: 15px;
      display: none;
    }

    .results.show {
      display: block;
      animation: slideIn 0.4s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .result-item {
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #cbd5e0;
    }

    .result-item:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .result-label {
      color: #4a5568;
      font-size: 0.875rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .result-value {
      color: #2d3748;
      font-size: 1.75rem;
      font-weight: 700;
    }

    .highlight {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1.5rem;
      border-radius: 10px;
      margin-top: 1rem;
    }

    .table-container {
      margin-top: 1.5rem;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
    }

    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #cbd5e0;
    }

    th {
      background: #edf2f7;
      color: #4a5568;
      font-weight: 600;
    }

    td {
      color: #2d3748;
    }

    .products-section {
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 2px solid #cbd5e0;
    }

    .products-table {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .product-header {
      display: grid;
      grid-template-columns: 1.5fr 4fr;
      gap: 1rem;
      padding: 1rem 1.5rem;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 10px;
      font-weight: 600;
      font-size: 0.875rem;
    }

    .header-cell {
      text-align: center;
    }

    .header-cell:first-child {
      text-align: left;
    }

    .header-inputs {
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr;
      gap: 1rem;
      align-items: center;
    }

    .product-row {
      display: grid;
      grid-template-columns: 1.5fr 4fr;
      align-items: center;
      padding: 1.5rem;
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      transition: all 0.3s ease;
      gap: 1rem;
    }

    .product-row:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
    }

    .product-info {
      display: flex;
      flex-direction: column;
    }

    .product-name {
      font-size: 1.125rem;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 0.25rem;
    }

    .product-selector {
      font-size: 1.125rem;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 0.25rem;
      padding: 0.5rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .product-selector:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .product-tax {
      font-size: 0.875rem;
      color: #718096;
      font-weight: 500;
    }

    .product-inputs {
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr;
      gap: 1rem;
      align-items: center;
    }

    .product-price {
      padding: 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1.125rem;
      font-weight: 600;
      text-align: center;
    }

    .product-price:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .product-total, .product-bruto, .product-result, .product-lucro {
      font-size: 0.875rem;
      font-weight: 600;
      text-align: center;
      padding: 0.75rem;
      border-radius: 6px;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .value-main {
      font-size: 1rem;
      font-weight: 700;
    }

    .value-percent {
      font-size: 0.75rem;
      opacity: 0.8;
      font-weight: 500;
    }

    .product-total {
      background: #e6fffa;
      color: #234e52;
    }

    .product-bruto {
      background: #fef5e7;
      color: #744210;
    }

    .product-result {
      background: #e0e7ff;
      color: #3730a3;
    }

    .product-lucro {
      background: #f0fff4;
      color: #22543d;
    }

    .totals-row {
      display: grid;
      grid-template-columns: 1.5fr 4fr;
      align-items: center;
      padding: 1.5rem;
      background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
      color: white;
      border-radius: 10px;
      gap: 1rem;
      margin-top: 1rem;
    }

    .totals-info {
      display: flex;
      flex-direction: column;
    }

    .totals-name {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .total-vendas, .total-imposto-bruto, .total-imposto-liquido, .total-lucro-presumido {
      font-size: 1rem;
      font-weight: 700;
      text-align: center;
      padding: 0.75rem;
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.2);
    }

    .comparison-row {
      display: grid;
      grid-template-columns: 1.5fr 4fr;
      align-items: center;
      padding: 1.5rem;
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: white;
      border-radius: 10px;
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .comparison-info {
      display: flex;
      flex-direction: column;
    }

    .comparison-name {
      font-size: 1.125rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .comparison-desc {
      font-size: 0.875rem;
      opacity: 0.9;
      font-weight: 500;
    }

    .economia-ncm, .diferenca-lucro {
      font-size: 1rem;
      font-weight: 700;
      text-align: center;
      padding: 0.75rem;
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.2);
    }

    select {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1rem;
      background: white;
      cursor: pointer;
    }

    select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }

      .container {
        padding: 1.5rem;
        max-width: 100%;
      }

      h1 {
        font-size: 1.5rem;
      }

      .product-header {
        display: none;
      }

      .product-row {
        grid-template-columns: 1fr;
        gap: 0.75rem;
        padding: 1rem;
      }

      .product-inputs {
        grid-template-columns: 1fr;
        gap: 0.5rem;
      }

      .totals-row, .comparison-row {
        grid-template-columns: 1fr;
        gap: 0.75rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Calculadora Simples Nacional</h1>
    <p class="subtitle">Anexo I - Restaurantes</p>
    
    <form id="calculator-form">
      <div class="input-group">
        <label for="faturamento">Faturamento Mensal Atual (R$)</label>
        <input type="text" id="faturamento" placeholder="Ex: 50000,00" required>
      </div>
      <button type="submit">Calcular Impostos</button>
    </form>

    <div class="results" id="results">
      <div class="result-item">
        <div class="result-label">RBT12 - Receita Bruta Anual</div>
        <div class="result-value" id="rbt12">R$ 0,00</div>
      </div>
      
      <div class="result-item">
        <div class="result-label">Faixa do Simples Nacional</div>
        <div class="result-value" id="faixa" style="font-size: 1.25rem;">-</div>
      </div>
      
      <div class="result-item">
        <div class="result-label">Alíquota Efetiva</div>
        <div class="result-value" id="aliquota">0%</div>
      </div>
      
      <div class="highlight">
        <div class="result-label" style="color: rgba(255,255,255,0.9);">Imposto Mensal a Pagar</div>
        <div class="result-value" style="color: white;" id="imposto-mensal">R$ 0,00</div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Faixa</th>
              <th>Receita Bruta em 12 Meses</th>
              <th>Alíquota</th>
              <th>Parcela a Deduzir</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>1ª</td><td>Até R$ 180.000,00</td><td>4,00%</td><td>-</td></tr>
            <tr><td>2ª</td><td>De R$ 180.000,01 a R$ 360.000,00</td><td>7,30%</td><td>R$ 5.940,00</td></tr>
            <tr><td>3ª</td><td>De R$ 360.000,01 a R$ 720.000,00</td><td>9,50%</td><td>R$ 13.860,00</td></tr>
            <tr><td>4ª</td><td>De R$ 720.000,01 a R$ 1.800.000,00</td><td>10,70%</td><td>R$ 22.500,00</td></tr>
            <tr><td>5ª</td><td>De R$ 1.800.000,01 a R$ 3.600.000,00</td><td>14,30%</td><td>R$ 87.300,00</td></tr>
            <tr><td>6ª</td><td>De R$ 3.600.000,01 a R$ 4.800.000,00</td><td>19,00%</td><td>R$ 378.000,00</td></tr>
          </tbody>
        </table>
      </div>

      <div class="products-section">
        <h3 style="color: #2d3748; margin: 2rem 0 1rem 0; font-size: 1.5rem;">Cálculo por Produto</h3>
        
        <div class="products-table">
          <div class="product-header">
            <div class="header-cell">Produto</div>
            <div class="header-inputs">
              <div class="header-cell">Preço Unit.</div>
              <div class="header-cell">Valor</div>
              <div class="header-cell">Imposto sem análise NCM</div>
              <div class="header-cell">Imposto com análise NCM</div>
              <div class="header-cell">Imposto no Lucro Presumido</div>
            </div>
          </div>

          <div class="product-row">
            <div class="product-info">
              <select class="product-selector" id="product-selector-1" data-row="1">
                <option value="hamburguer">Hambúrguer</option>
                <option value="pizza">Pizza</option>
                <option value="outras-refeicoes">Outras Refeições Completas</option>
              </select>
              <span class="product-tax">Alíquota Efetiva Completa</span>
            </div>
            <div class="product-inputs">
              <input type="text" class="product-price" data-product="hamburguer" data-row="1" placeholder="Preço (R$)">
              <div class="product-total" id="produto1-total">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-bruto" id="produto1-bruto">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-result" id="produto1-result">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-lucro" id="produto1-lucro">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
            </div>
          </div>

          <div class="product-row">
            <div class="product-info">
              <span class="product-name">Batata</span>
              <span class="product-tax">Sem ICMS</span>
            </div>
            <div class="product-inputs">
              <input type="text" class="product-price" data-product="batata" placeholder="Preço (R$)">
              <div class="product-total" id="batata-total">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-bruto" id="batata-bruto">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-result" id="batata-result">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-lucro" id="batata-lucro">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
            </div>
          </div>

          <div class="product-row">
            <div class="product-info">
              <span class="product-name">Sobremesa</span>
              <span class="product-tax">Sem ICMS</span>
            </div>
            <div class="product-inputs">
              <input type="text" class="product-price" data-product="sobremesa" placeholder="Preço (R$)">
              <div class="product-total" id="sobremesa-total">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-bruto" id="sobremesa-bruto">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-result" id="sobremesa-result">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-lucro" id="sobremesa-lucro">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
            </div>
          </div>

          <div class="product-row">
            <div class="product-info">
              <span class="product-name">Refrigerante</span>
              <span class="product-tax">Sem PIS/COFINS/ICMS</span>
            </div>
            <div class="product-inputs">
              <input type="text" class="product-price" data-product="refrigerante" placeholder="Preço (R$)">
              <div class="product-total" id="refrigerante-total">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-bruto" id="refrigerante-bruto">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-result" id="refrigerante-result">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
              <div class="product-lucro" id="refrigerante-lucro">
                <span class="value-main">R$ 0,00</span>
                <span class="value-percent">-</span>
              </div>
            </div>
          </div>

          <div class="totals-row">
            <div class="totals-info">
              <span class="totals-name">TOTAIS GERAIS</span>
            </div>
            <div class="product-inputs">
              <div style="visibility: hidden;">-</div>
              <div class="total-vendas" id="total-vendas">R$ 0,00</div>
              <div class="total-imposto-bruto" id="total-imposto-bruto">R$ 0,00</div>
              <div class="total-imposto-liquido" id="total-imposto-liquido">R$ 0,00</div>
              <div class="total-lucro-presumido" id="total-lucro-presumido">R$ 0,00</div>
            </div>
          </div>

          <div class="comparison-row">
            <div class="comparison-info">
              <span class="comparison-name">ECONOMIA COM ANÁLISE NCM</span>
              <span class="comparison-desc">Diferença: Sem análise - Com análise</span>
            </div>
            <div class="product-inputs">
              <div style="visibility: hidden;">-</div>
              <div style="visibility: hidden;">-</div>
              <div style="visibility: hidden;">-</div>
              <div class="economia-ncm" id="economia-ncm">R$ 0,00</div>
              <div style="visibility: hidden;">-</div>
            </div>
          </div>

          <div class="comparison-row">
            <div class="comparison-info">
              <span class="comparison-name">DIFERENÇA LUCRO PRESUMIDO</span>
              <span class="comparison-desc">Diferença: Sem análise - Lucro Presumido</span>
            </div>
            <div class="product-inputs">
              <div style="visibility: hidden;">-</div>
              <div style="visibility: hidden;">-</div>
              <div style="visibility: hidden;">-</div>
              <div style="visibility: hidden;">-</div>
              <div class="diferenca-lucro" id="diferenca-lucro">R$ 0,00</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 2rem; padding: 2rem; background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%); border-radius: 15px;">
          <h3 style="color: #2d3748; margin: 0 0 1.5rem 0; font-size: 1.5rem;">Cálculo por Estado e Produto</h3>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
            <div>
              <label style="display: block; color: #4a5568; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.875rem;">Estado</label>
              <select id="estado-selector">
                <option value="">Selecione o estado</option>
                <option value="AC">Acre</option>
                <option value="AL">Alagoas</option>
                <option value="AP">Amapá</option>
                <option value="AM">Amazonas</option>
                <option value="BA">Bahia</option>
                <option value="CE">Ceará</option>
                <option value="DF">Distrito Federal</option>
                <option value="ES">Espírito Santo</option>
                <option value="GO">Goiás</option>
                <option value="MA">Maranhão</option>
                <option value="MT">Mato Grosso</option>
                <option value="MS">Mato Grosso do Sul</option>
                <option value="MG">Minas Gerais</option>
                <option value="PA">Pará</option>
                <option value="PB">Paraíba</option>
                <option value="PR">Paraná</option>
                <option value="PE">Pernambuco</option>
                <option value="PI">Piauí</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="RN">Rio Grande do Norte</option>
                <option value="RS">Rio Grande do Sul</option>
                <option value="RO">Rondônia</option>
                <option value="RR">Roraima</option>
                <option value="SC">Santa Catarina</option>
                <option value="SP">São Paulo</option>
                <option value="SE">Sergipe</option>
                <option value="TO">Tocantins</option>
              </select>
            </div>
            
            <div>
              <label style="display: block; color: #4a5568; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.875rem;">Produto</label>
              <select id="produto-estado-selector">
                <option value="">Selecione o produto</option>
                <optgroup label="Refeições Completas (Simples - Alíquota Completa)">
                  <option value="hamburguer">Hambúrguer</option>
                  <option value="pizza">Pizza</option>
                  <option value="outras-refeicoes">Outras Refeições Completas</option>
                  <option value="sushi">Sushi</option>
                  <option value="sashimi">Sashimi</option>
                </optgroup>
                <optgroup label="Acompanhamentos (Simples - Sem ICMS)">
                  <option value="batata">Batata frita</option>
                  <option value="sobremesa">Sobremesa</option>
                  <option value="salada">Salada</option>
                  <option value="arroz">Arroz</option>
                  <option value="feijao">Feijão</option>
                </optgroup>
                <optgroup label="Bebidas Monofásicas (Sem PIS/COFINS/ICMS)">
                  <option value="refrigerante">Refrigerante</option>
                  <option value="cerveja">Cerveja</option>
                  <option value="vinho">Vinho</option>
                  <option value="agua-industrializada">Água mineral</option>
                </optgroup>
              </select>
            </div>
          </div>

          <div style="margin-bottom: 1.5rem;">
            <label style="display: block; color: #4a5568; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.875rem;">Valor do Produto (R$)</label>
            <input type="text" id="produto-estado-valor" placeholder="Ex: 50,00" style="width: 100%; padding: 0.875rem 1rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1.125rem; box-sizing: border-box;">
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
            <div style="padding: 1.5rem; background: white; border-radius: 10px; border: 2px solid #667eea;">
              <div style="color: #718096; font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">ALÍQUOTA SIMPLES NACIONAL</div>
              <div id="aliquota-simples-nacional" style="color: #667eea; font-size: 2rem; font-weight: 700;">-</div>
            </div>
            <div style="padding: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
              <div style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; opacity: 0.9;">VALOR IMPOSTO (SIMPLES)</div>
              <div id="valor-imposto-simples" style="font-size: 2rem; font-weight: 700;">R$ 0,00</div>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div style="padding: 1.5rem; background: white; border-radius: 10px; border: 2px solid #48bb78;">
              <div style="color: #718096; font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">ALÍQUOTA LUCRO PRESUMIDO</div>
              <div id="aliquota-lucro-presumido" style="color: #48bb78; font-size: 2rem; font-weight: 700;">-</div>
            </div>
            <div style="padding: 1.5rem; background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); border-radius: 10px; color: white;">
              <div style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; opacity: 0.9;">VALOR IMPOSTO (LUCRO PRESUMIDO)</div>
              <div id="valor-imposto-lucro" style="font-size: 2rem; font-weight: 700;">R$ 0,00</div>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
            <div style="padding: 1.5rem; background: white; border-radius: 10px; border: 2px solid #ed8936;">
              <div style="color: #718096; font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">ALÍQUOTA LUCRO REAL</div>
              <div id="aliquota-lucro-real" style="color: #ed8936; font-size: 2rem; font-weight: 700;">-</div>
            </div>
            <div style="padding: 1.5rem; background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%); border-radius: 10px; color: white;">
              <div style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; opacity: 0.9;">VALOR IMPOSTO (LUCRO REAL)</div>
              <div id="valor-imposto-lucro-real" style="font-size: 2rem; font-weight: 700;">R$ 0,00</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const tabelaAnexoI = [
      { limite: 180000, aliquota: 4.00, deducao: 0 },
      { limite: 360000, aliquota: 7.30, deducao: 5940 },
      { limite: 720000, aliquota: 9.50, deducao: 13860 },
      { limite: 1800000, aliquota: 10.70, deducao: 22500 },
      { limite: 3600000, aliquota: 14.30, deducao: 87300 },
      { limite: 4800000, aliquota: 19.00, deducao: 378000 }
    ];

    const distribuicaoImpostos = {
      irpj: 5.50,
      csll: 3.50,
      cofins: 12.74,
      pis: 2.76,
      cpp: 41.50,
      icms: 34.00
    };

    const aliquotasLucroPresumido = {
      hamburguer: 9.93,
      pizza: 9.93,
      'outras-refeicoes': 9.93,
      batata: 5.93,
      sobremesa: 2.28,
      refrigerante: 2.28,
      'sorvete-massa': 2.28,
      'picole': 2.28,
      'acai': 2.28,
      'casquinha': 2.28,
      'milkshake': 2.28,
      'frozen-yogurt': 2.28
    };

    const aliquotasICMSLucroReal = {
      'SP': 4.00, 'RJ': 4.00, 'MG': 4.00, 'ES': 4.00, 'PR': 4.00, 'SC': 4.00,
      'RS': 4.00, 'DF': 4.00, 'GO': 4.00, 'MT': 4.00, 'MS': 4.00,
      'BA': 7.00, 'CE': 7.00, 'PE': 7.00, 'AL': 7.00, 'SE': 7.00,
      'PB': 7.00, 'RN': 7.00, 'PI': 7.00, 'MA': 7.00, 'PA': 7.00,
      'AP': 7.00, 'AM': 7.00, 'RR': 7.00, 'AC': 7.00, 'RO': 7.00, 'TO': 7.00
    };

    const produtosMonofasicos = [
      'refrigerante', 'suco-industrializado', 'agua-industrializada',
      'energetico', 'cha-gelado', 'isotonico', 'agua-coco',
      'cerveja', 'vinho', 'whisky', 'vodka', 'gin', 'cachaca', 'licor',
      'sorvete-massa', 'picole', 'acai', 'casquinha', 'milkshake'
    ];

    let aliquotaEfetivaGlobal = 0;

    function formatarMoeda(valor) {
      return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    function calcularDeducaoImposto(aliquotaEfetiva, percentuaisRemover) {
      let somaPercentuais = 0;
      percentuaisRemover.forEach(p => {
        somaPercentuais += p;
      });
      return (somaPercentuais / 100) * aliquotaEfetiva;
    }

    function calcularImpostos(faturamentoMensal) {
      const rbt12 = faturamentoMensal * 12;
      
      let faixa = null;
      for (let i = 0; i < tabelaAnexoI.length; i++) {
        if (rbt12 <= tabelaAnexoI[i].limite) {
          faixa = tabelaAnexoI[i];
          break;
        }
      }

      if (!faixa) {
        return {
          rbt12,
          faixaTexto: "Acima do limite do Simples Nacional",
          aliquotaEfetiva: 0,
          impostoMensal: 0
        };
      }

      const aliquotaEfetiva = ((rbt12 * faixa.aliquota / 100) - faixa.deducao) / rbt12 * 100;
      const impostoMensal = faturamentoMensal * aliquotaEfetiva / 100;
      
      aliquotaEfetivaGlobal = aliquotaEfetiva;

      return {
        rbt12,
        faixaTexto: `${faixa.aliquota}% (Até ${formatarMoeda(faixa.limite)})`,
        aliquotaEfetiva,
        impostoMensal
      };
    }

    function calcularImpostoProduto(preco, tipoProduto) {
      if (aliquotaEfetivaGlobal === 0) return 0;

      let aliquotaProduto = aliquotaEfetivaGlobal;

      if (produtosMonofasicos.includes(tipoProduto)) {
        const deducao = calcularDeducaoImposto(aliquotaEfetivaGlobal, [
          distribuicaoImpostos.pis,
          distribuicaoImpostos.cofins,
          distribuicaoImpostos.icms
        ]);
        aliquotaProduto = aliquotaEfetivaGlobal - deducao;
      } else if (['hamburguer', 'pizza', 'outras-refeicoes', 'sushi', 'sashimi'].includes(tipoProduto)) {
        aliquotaProduto = aliquotaEfetivaGlobal;
      } else {
        const deducao = calcularDeducaoImposto(aliquotaEfetivaGlobal, [
          distribuicaoImpostos.icms
        ]);
        aliquotaProduto = aliquotaEfetivaGlobal - deducao;
      }

      return preco * aliquotaProduto / 100;
    }

    function calcularImpostoLucroPresumido(preco, tipoProduto) {
      const aliquota = aliquotasLucroPresumido[tipoProduto] || 5.93;
      return preco * aliquota / 100;
    }

    function calcularAliquotaLucroReal(estado, produto) {
      const baseImpostos = 1.65 + 7.6; // PIS + COFINS
      
      if (produtosMonofasicos.includes(produto)) {
        return 0;
      } else {
        const icms = aliquotasICMSLucroReal[estado] || 4.00;
        return baseImpostos + icms;
      }
    }

    document.getElementById('calculator-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const input = document.getElementById('faturamento').value;
      const faturamento = parseFloat(input.replace(/\./g, '').replace(',', '.'));

      if (isNaN(faturamento) || faturamento <= 0) {
        return;
      }

      const resultado = calcularImpostos(faturamento);

      document.getElementById('rbt12').textContent = formatarMoeda(resultado.rbt12);
      document.getElementById('faixa').textContent = resultado.faixaTexto;
      document.getElementById('aliquota').textContent = resultado.aliquotaEfetiva.toFixed(2) + '%';
      document.getElementById('imposto-mensal').textContent = formatarMoeda(resultado.impostoMensal);

      document.getElementById('results').classList.add('show');
    });

    document.getElementById('faturamento').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 0) {
        value = (parseInt(value) / 100).toFixed(2);
        value = value.replace('.', ',');
        value = value.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      }
      e.target.value = value;
    });

    function calcularTotais() {
      let totalVendas = 0;
      let totalImpostoBruto = 0;
      let totalImpostoLiquido = 0;
      let totalLucroPresumido = 0;

      const produto1Selector = document.getElementById('product-selector-1');
      const produto1Input = document.querySelector('[data-row="1"].product-price');
      const produto1Tipo = produto1Selector.value;
      
      const preco1Value = produto1Input.value.replace(/\./g, '').replace(',', '.');
      const preco1 = parseFloat(preco1Value) || 0;
      
      const imposto1Bruto = preco1 * aliquotaEfetivaGlobal / 100;
      const imposto1Liquido = calcularImpostoProduto(preco1, produto1Tipo);
      const imposto1LucroPresumido = calcularImpostoLucroPresumido(preco1, produto1Tipo);

      document.getElementById('produto1-total').querySelector('.value-main').textContent = formatarMoeda(preco1);
      document.getElementById('produto1-total').querySelector('.value-percent').textContent = '-';
      
      const percent1Bruto = preco1 > 0 ? (imposto1Bruto / preco1 * 100).toFixed(2) + '%' : '-';
      document.getElementById('produto1-bruto').querySelector('.value-main').textContent = formatarMoeda(imposto1Bruto);
      document.getElementById('produto1-bruto').querySelector('.value-percent').textContent = percent1Bruto;
      
      const percent1Liquido = preco1 > 0 ? (imposto1Liquido / preco1 * 100).toFixed(2) + '%' : '-';
      document.getElementById('produto1-result').querySelector('.value-main').textContent = formatarMoeda(imposto1Liquido);
      document.getElementById('produto1-result').querySelector('.value-percent').textContent = percent1Liquido;
      
      const percent1LucroPresumido = preco1 > 0 ? (imposto1LucroPresumido / preco1 * 100).toFixed(2) + '%' : '-';
      document.getElementById('produto1-lucro').querySelector('.value-main').textContent = formatarMoeda(imposto1LucroPresumido);
      document.getElementById('produto1-lucro').querySelector('.value-percent').textContent = percent1LucroPresumido;

      totalVendas += preco1;
      totalImpostoBruto += imposto1Bruto;
      totalImpostoLiquido += imposto1Liquido;
      totalLucroPresumido += imposto1LucroPresumido;

      ['batata', 'sobremesa', 'refrigerante'].forEach(produto => {
        const precoInput = document.querySelector(`[data-product="${produto}"].product-price`);
        
        const precoValue = precoInput.value.replace(/\./g, '').replace(',', '.');
        const preco = parseFloat(precoValue) || 0;
        
        const impostoBruto = preco * aliquotaEfetivaGlobal / 100;
        const impostoLiquido = calcularImpostoProduto(preco, produto);
        const impostoLucroPresumido = calcularImpostoLucroPresumido(preco, produto);

        document.getElementById(produto + '-total').querySelector('.value-main').textContent = formatarMoeda(preco);
        document.getElementById(produto + '-total').querySelector('.value-percent').textContent = '-';
        
        const percentBruto = preco > 0 ? (impostoBruto / preco * 100).toFixed(2) + '%' : '-';
        document.getElementById(produto + '-bruto').querySelector('.value-main').textContent = formatarMoeda(impostoBruto);
        document.getElementById(produto + '-bruto').querySelector('.value-percent').textContent = percentBruto;
        
        const percentLiquido = preco > 0 ? (impostoLiquido / preco * 100).toFixed(2) + '%' : '-';
        document.getElementById(produto + '-result').querySelector('.value-main').textContent = formatarMoeda(impostoLiquido);
        document.getElementById(produto + '-result').querySelector('.value-percent').textContent = percentLiquido;
        
        const percentLucroPresumido = preco > 0 ? (impostoLucroPresumido / preco * 100).toFixed(2) + '%' : '-';
        document.getElementById(produto + '-lucro').querySelector('.value-main').textContent = formatarMoeda(impostoLucroPresumido);
        document.getElementById(produto + '-lucro').querySelector('.value-percent').textContent = percentLucroPresumido;

        totalVendas += preco;
        totalImpostoBruto += impostoBruto;
        totalImpostoLiquido += impostoLiquido;
        totalLucroPresumido += impostoLucroPresumido;
      });

      document.getElementById('total-vendas').textContent = formatarMoeda(totalVendas);
      document.getElementById('total-imposto-bruto').textContent = formatarMoeda(totalImpostoBruto);
      document.getElementById('total-imposto-liquido').textContent = formatarMoeda(totalImpostoLiquido);
      document.getElementById('total-lucro-presumido').textContent = formatarMoeda(totalLucroPresumido);

      const economiaNcm = totalImpostoBruto - totalImpostoLiquido;
      const diferencaLucro = totalImpostoBruto - totalLucroPresumido;

      document.getElementById('economia-ncm').textContent = formatarMoeda(economiaNcm);
      document.getElementById('diferenca-lucro').textContent = formatarMoeda(diferencaLucro);
    }

    document.querySelectorAll('.product-price').forEach(input => {
      input.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 0) {
          value = (parseInt(value) / 100).toFixed(2);
          value = value.replace('.', ',');
          value = value.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }
        e.target.value = value;
        calcularTotais();
      });
    });

    document.getElementById('product-selector-1').addEventListener('change', function() {
      calcularTotais();
    });

    function calcularImpostoEstadoProduto() {
      const estado = document.getElementById('estado-selector').value;
      const produto = document.getElementById('produto-estado-selector').value;
      const valorInput = document.getElementById('produto-estado-valor').value;

      if (!estado || !produto || !valorInput) {
        document.getElementById('aliquota-simples-nacional').textContent = '-';
        document.getElementById('valor-imposto-simples').textContent = 'R$ 0,00';
        document.getElementById('aliquota-lucro-presumido').textContent = '-';
        document.getElementById('valor-imposto-lucro').textContent = 'R$ 0,00';
        document.getElementById('aliquota-lucro-real').textContent = '-';
        document.getElementById('valor-imposto-lucro-real').textContent = 'R$ 0,00';
        return;
      }

      const valor = parseFloat(valorInput.replace(/\./g, '').replace(',', '.')) || 0;
      
      if (valor <= 0) {
        document.getElementById('aliquota-simples-nacional').textContent = '-';
        document.getElementById('valor-imposto-simples').textContent = 'R$ 0,00';
        document.getElementById('aliquota-lucro-presumido').textContent = '-';
        document.getElementById('valor-imposto-lucro').textContent = 'R$ 0,00';
        document.getElementById('aliquota-lucro-real').textContent = '-';
        document.getElementById('valor-imposto-lucro-real').textContent = 'R$ 0,00';
        return;
      }

      let aliquotaSimples = 0;
      
      if (produtosMonofasicos.includes(produto)) {
        const deducao = calcularDeducaoImposto(aliquotaEfetivaGlobal, [
          distribuicaoImpostos.pis,
          distribuicaoImpostos.cofins,
          distribuicaoImpostos.icms
        ]);
        aliquotaSimples = aliquotaEfetivaGlobal - deducao;
      } else if (['hamburguer', 'pizza', 'outras-refeicoes', 'sushi', 'sashimi'].includes(produto)) {
        aliquotaSimples = aliquotaEfetivaGlobal;
      } else {
        const deducao = calcularDeducaoImposto(aliquotaEfetivaGlobal, [
          distribuicaoImpostos.icms
        ]);
        aliquotaSimples = aliquotaEfetivaGlobal - deducao;
      }

      const valorImpostoSimples = valor * aliquotaSimples / 100;
      const aliquotaLucro = aliquotasLucroPresumido[produto] || 5.93;
      const valorImpostoLucro = valor * aliquotaLucro / 100;
      const aliquotaReal = calcularAliquotaLucroReal(estado, produto);
      const valorImpostoReal = valor * aliquotaReal / 100;

      document.getElementById('aliquota-simples-nacional').textContent = aliquotaSimples.toFixed(2) + '%';
      document.getElementById('valor-imposto-simples').textContent = formatarMoeda(valorImpostoSimples);
      document.getElementById('aliquota-lucro-presumido').textContent = aliquotaLucro.toFixed(2) + '%';
      document.getElementById('valor-imposto-lucro').textContent = formatarMoeda(valorImpostoLucro);
      document.getElementById('aliquota-lucro-real').textContent = aliquotaReal.toFixed(2) + '%';
      document.getElementById('valor-imposto-lucro-real').textContent = formatarMoeda(valorImpostoReal);
    }

    document.getElementById('estado-selector').addEventListener('change', calcularImpostoEstadoProduto);
    document.getElementById('produto-estado-selector').addEventListener('change', calcularImpostoEstadoProduto);
    
    document.getElementById('produto-estado-valor').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 0) {
        value = (parseInt(value) / 100).toFixed(2);
        value = value.replace('.', ',');
        value = value.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      }
      e.target.value = value;
      calcularImpostoEstadoProduto();
    });
  </script>
</body>
</html>
